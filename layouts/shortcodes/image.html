{{/*Retrive Passed Shortcode Parameters*/}}
{{ $src := .Get "src" }}
{{ $alt := .Get "alt" }}

{{/*Define variables as global variables to make them accessable in this shortcode*/}}
{{ $DarkImage := "" }}
{{ $LightImage := "" }}
{{ $SingleImage := "" }}

{{/*Find images and update the previous Single,Dark,Light Images variables*/}}
{{ with resources.GetMatch (print $src "-Dark" ".jpg") }} {{ $DarkImage = . }} {{ end }}
{{ with resources.GetMatch (print $src "-Light" ".jpg") }} {{ $LightImage = . }} {{ end }}
{{ with resources.GetMatch (print $src ".jpg") }} {{ $SingleImage = . }} {{ end }}
{{ with resources.GetMatch (print $src "-Dark" ".png") }} {{ $DarkImage = . }} {{ end }}
{{ with resources.GetMatch (print $src "-Light" ".png") }} {{ $LightImage = . }} {{ end }}
{{ with resources.GetMatch (print $src ".png") }} {{ $SingleImage = . }} {{ end }}


{{ if $SingleImage }}
    <img {{ with $SingleImage }}
        src="{{ .RelPermalink }}"
        width="{{ .Width }}"
        height="{{ .Height }}"
        {{end}}{{ with $alt }}alt="{{.}}"{{ else }}alt=""{{ end }}/>
{{ else }}
<picture>
    {{ with $SingleImage }}<source srcset="{{ .RelPermalink }}">{{ end }}
    {{ with $DarkImage }}<source srcset="{{ .RelPermalink }}" media="(prefers-color-scheme: dark)">{{ end }}
    {{ with $LightImage }}<source srcset="{{ .RelPermalink }}" media="(prefers-color-scheme: light)">{{ end }}
    <img {{ with $SingleImage }}
        src="{{ .RelPermalink }}"
        Width="{{ .Width }}"
        height="{{ .Height }}"
        {{ else with $LightImage }}
        src="{{ .RelPermalink }}"
        Width="{{ .Width }}"
        height="{{ .Height }}"
        {{ else with $DarkImage }}
        src="{{ .RelPermalink }}"
        Width="{{ .Width }}"
        height="{{ .Height }}"
        {{ end }}{{ with $alt }}alt="{{.}}"{{ else }}alt=""{{ end }}/>
</picture>
{{ end }}
